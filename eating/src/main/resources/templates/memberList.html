<!DOCTYPE html>
<html xmlns:th="http://www.thymeLeaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>

<!-- 스크립트 -->
<script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
<script type="text/javascript">
	$(function() {
		var chkObj = document.getElementsByName("RowCheck");
		var rawCnt = chkObj.length;

		$("input[name='allCheck']").click(function() {
			var chk_listArr = $("input[name='RowCheck']");
			for (var i = 0; i < chk_listArr.length; i++) {
				chk_listArr[i].checked = this.checked;
			}
		});
		$("input[name='RowCheck']").click(function() {
			if ($("input[name='RowCheck']:checked").length == rowCnt) {
				$("input[name='allCheck']")[0].checked = true;
			} else {
				$("input[name='allCheck']")[0].checked = false;
			}
		});
	});
	function delelteValue() {
		var url = "delete";
		var valueArr = new Array();
		var list = $("input[name='RowCheck']");
		for (var i = 0; i < list.length; i++) {
			if (list[i].checked) {
				valueArr.push(list[i].value);
			}
		}
		if (valueArr.length == 0) {
			alert("선택된 글이 없습니다.");
		} else {
			var chk = confirm("정말 삭제하시겠습니까?");
			$.ajax({
				url : url,
				type : 'POST',
				traditional : true,
				data : {
					valueArr : valueArr
				},
				succeess : function(jdata) {
					if (jdata = 1) {
						alert("삭제 성공");
						location.replace("list")
					} else {
						alert("삭제 실패")
					}
				}
			});
		}
	}

	var checkRows = $("[name='allCheck']:checked");
	for (var i = checkRows.length - 1; i > -1; i--) {
		checkRows.eq(i).closest('tr').remove();

	}
</script>

<body>
	<h1>회원 목록</h1>

	<div>

		<table border="1">
			<thead>
				<tr>
					<th scope="col"><input id="allcheck" type="checkbox"
						name="allCheck"></th>
					<th scope="col">아이디</th>
					<th scope="col">사용자아이디</th>
					<th scope="col">비밀번호</th>
					<th scope="col">이름</th>
					<th scope="col">전화번호</th>
					<th scope="col">등급</th>
					<th></th>
				</tr>
			</thead>

			<tbody>
				<c:foreach itmes="${list}" var="list">

					<tr th:each="member : ${selectAll }">
						<td class="header" width="30"><input name="RowCheck"
							type="checkbox" id="checkall"></td>
						<td th:text="${member.id}"></td>
						<td th:text="${member.userId}"></td>
						<td th:text="${member.userPw}"></td>
						<td th:text="${member.userName}"></td>
						<td th:text="${member.phoneNumber}"></td>
						<td th:text="${member.grade}"></td>
						<td><input type="button" value="수정" /></td>
					</tr>
				</c:foreach>
		</table>
		</tbody>
		<input type="button" value="선택삭제" class="btn btn-outline-info"
			onclick="deleteValue()">
	</div>

</body>

</html>